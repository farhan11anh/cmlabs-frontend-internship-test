<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu</title>

    <!-- bootstrap -->
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <!-- style -->
    <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>

    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
        <h5 class="my-0 mr-md-auto font-weight-normal">Han's Food</h5>
        <nav class="my-2 my-md-0 mr-md-3">
          <a class="p-2 text-dark" href="./index.html">Home</a>
          <a class="p-2 text-dark" href="#">Food</a>
          <a class="p-2 text-dark" href="#">Info</a>
          <a class="p-2 text-dark" href="#">Pricing</a>
        </nav>
    </div>

    <div class="container">
        <h2 class="" >Menu <span id="title" ></span> </h2>

        <div class="row" id="menu">
            <!-- menu -->

        </div>

    </div>
    

    <!-- bootstrap js -->
    <script src="./assets/js/bootstrap.min.js"></script>
    <script src="./assets/js/bootstrap.bundle.min.js"></script>

    <!-- jquery -->
    <script src="./assets/js/jquery.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>

    <script>

        const category = localStorage.getItem('category');
        const url = `https://www.themealdb.com/api/json/v1/1/filter.php?c=${category}`;
        console.log(url);

        $.ajax({
            url : url,
            method : 'get',
            error : (err)=>{
                console.log('error');
                const content = `
                <div class="col-12 mt-5">
                    <h4 class="text-center">Data Not Found</h4>
                </div>
                `;
                $('#category').append(content)
            }
        }).done((data)=>{
            console.log(data);
            $('#title').html(category)


            for(const item of data.meals){
                // console.log(item);
                const content = `
                <div class="col-md-3 col-sm-4 col-xs-6 bott-buffer cat-item">
                    <div class="card" style="width: 100%;">
                        <div class="img" >
                            <img class="card-img-top" src="${item.strMealThumb}" alt="Card image cap">
                        </div>
                        <div class="card-body">
                            <h6>${item.strMeal}</h6>
                        </div>
                    </div>
                </div>
                `
                $('#menu').append(content)
            }

            $( document ).ready(function() {
                
                // get category name
                let category;
                $('.cat-item').click((e)=>{
                    // console.log($(e.currentTarget).children('.card').children('.card-body').children('h5')[0].innerHTML)
                    detail = $(e.currentTarget).children('.card').children('.card-body').children('h6')[0].innerHTML;

                    window.location.href=`detail.html?detail=${detail}`

                    // set detail at local storage
                    localStorage.removeItem('detail');
                    localStorage.setItem('detail', detail)
                })
                
            });
        })

        // $(document).ready(function(){
        // var idx = document.URL.indexOf('?category=');
    
        // if (idx !== -1) {
        //     console.log(document.URL.indexOf('?category='));
        //     console.log(document.URL);
        // }
        // });
    </script>
</body>
</html>